name: Git version
description: Calculate version metadata based on Git and GitHub Actions state

outputs:
  version-suffix:
    value: ${{ steps.version.outputs.version-suffix }}
  release-url:
    value: ${{ steps.version.outputs.release-url }}
  release-meta:
    value: ${{ steps.version.outputs.release-meta }}
  release-notes:
    value: ${{ steps.version.outputs.release-notes }}
  prerelease:
    value: ${{ steps.version.outputs.prerelease }}

runs:
  using: composite
  steps:
    - name: Calculate Git version
      id: version
      shell: pwsh
      env:
        gh: ${{ toJson(github) }}
      run: |
        ./.github/actions/git-version/calc-git-version.ps1 ($env:gh | ConvertFrom-Json)